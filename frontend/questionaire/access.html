<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<script type="module" src="/js/survey/api.js"></script>
<title>Enter Code</title>
<style>
@font-face {
  font-family: 'Trajan';
  src: local('Trajan Pro'), local('Trajan'), serif;
}

html, body {
  height: 100%;
  margin: 0;
  background-color: #fafafa;
  font-family: 'Trajan', serif;
  font-weight: 200;
  font-size: 17px;
  text-shadow: 0px 2px 4px rgba(0,0,0,0.09); /* 9% shadow */
  color: rgba(0,0,0,0.75);
  cursor: none;
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  overflow: hidden;
}

/* subtle vignette */
body::before {
  content: "";
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  pointer-events: none;
  background: radial-gradient(circle, rgba(0,0,0,0) 60%, rgba(0,0,0,0.035) 100%);
  z-index: 1;
}

/* Pantone Silence mask at 17% opacity */
body::after {
  content: "";
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background-color: rgba(246,239,229,0.17); /* 17% opacity */
  mix-blend-mode: darken;
  pointer-events: none;
  z-index: 2;
}

.container {
  max-width: 500px;
  text-align: center;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  position: relative;
  z-index: 3;
}

p {
  font-family: 'Trajan', serif;
  line-height: 1.8;
  letter-spacing: 0.09em;
  margin-bottom: 40px;
  color: rgba(0,0,0,0.75);
  font-size: 13.59px;
}

.code-inputs {
  display: flex;
  justify-content: center;
  gap: 20px;
}

.code-inputs input {
  width: 40px;                 /* smaller width */
  height: 40px;                /* smaller height */
  text-align: center;
  font-size: 20px;             /* slightly smaller text */
 text-shadow: 0px 2px 4px rgba(0,0,0,0.09); /* 9% shadow */
  font-family: 'Trajan', serif;
  font-weight: 200;
  color: rgba(0,0,0,0.75);
  letter-spacing: 0.09em;
  background: rgba(250,250,250,0.1);
  border: 1px solid rgba(0,0,0,0.1);  /* thinner border */
  border-radius: 8px;
  outline: none;
}

.code-inputs input:focus {
  border-color: rgba(0,0,0,0.75);
}

#custom-cursor {
  position: fixed;
  top: 0; left: 0;
  width: 34px; height: 34px;
  border-radius: 50%;
  pointer-events: none;
  background-color: rgba(0,0,0,0.05);
  transform: translate(-50%, -50%);
  transition: background-color 0.3s, width 0.3s, height 0.3s, opacity 0.2s;
  z-index: 9999;
}
</style>
</head>
<body>

<div class="container">
  <div class="code-inputs">
    <input type="text" maxlength="1" />
    <input type="text" maxlength="1" />
    <input type="text" maxlength="1" />
    <input type="text" maxlength="1" />
    <input type="text" maxlength="1" />
    <input type="text" maxlength="1" />
  </div>
</div>

<div id="custom-cursor"></div>

<script type="module">
  import * as api from "/js/survey/api.js";
// Custom cursor
const customCursor = document.getElementById('custom-cursor');
document.addEventListener('mousemove', e => {
  customCursor.style.transform = `translate(${e.clientX}px, ${e.clientY}px) translate(-50%, -50%)`;
});

// Auto-focus to next input and redirect after final digit
const inputs = document.querySelectorAll('.code-inputs input');
inputs.forEach((input, idx) => {
  input.addEventListener('input', () => {
    if(input.value.length === 1){
      if(idx < inputs.length - 1){
        inputs[idx + 1].focus();
      } else {
        let inputString = '';
        inputs.forEach(i => inputString += i.value);
        let intro = api.getIntro(inputString);
        if (intro){
          setTimeout(() => {
            window.location.href = "intro.html";
          }, 200);
      }
      }
    }
  });
  
  input.addEventListener('keydown', (e) => {
    if(e.key === 'Backspace' && input.value === '' && idx > 0){
      inputs[idx - 1].focus();
    }
  });
});
</script>

</body>
</html>
